<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b1020" />
  <title>Emergency Doctor Simulator</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="images/icon-192.png" />

  <!-- CSS -->
  <link rel="stylesheet" href="style.css?v=2.2.1" />
</head>

<body>

<!-- =========================
     SPLASH / CAPA INICIAL
     (N√ÉO DEPENDE do script.js)
========================= -->
<div id="splashScreen" class="splash" role="button" tabindex="0" aria-label="Toque para continuar">
  <img src="images/capa.jpg" alt="Emergency Doctor Simulator" />
  <div class="splashHint">Toque ou clique para continuar</div>
</div>

<script>
  // FIX DEFINITIVO: fecha a capa independente do script.js (mouse + touch + PWA)
  (function(){
    const splash = document.getElementById("splashScreen");
    if(!splash) return;

    function closeSplash(ev){
      try {
        if (ev && ev.preventDefault) ev.preventDefault();
        if (ev && ev.stopPropagation) ev.stopPropagation();
      } catch {}

      splash.classList.add("splash--hide");
      // d√° tempo para anima√ß√£o/repintura antes de remover do DOM
      setTimeout(()=> {
        if (splash && splash.parentNode) splash.parentNode.removeChild(splash);
      }, 180);
    }

    // capture=true garante que pega antes de qualquer overlay/handler
    const opts = { once: true, capture: true, passive: false };

    splash.addEventListener("pointerdown", closeSplash, opts);
    splash.addEventListener("mousedown", closeSplash, opts);
    splash.addEventListener("touchstart", closeSplash, opts);
    splash.addEventListener("click", closeSplash, opts);

    // acessibilidade / fallback teclado
    splash.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" || e.key === " "){
        closeSplash(e);
      }
    }, { once:true, capture:true });
  })();
</script>

<!-- =========================
     APP
========================= -->
<div class="app">

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="brand">
      <div class="brand-title">Emergency Doctor Simulator</div>
      <div class="brand-sub">Simulador educacional de pronto-socorro</div>
    </div>

    <div class="top-actions">
      <button id="btnFullScreen" class="chip">Tela cheia</button>
      <button id="btnRanking" class="chip">Ranking</button>
    </div>
  </header>

  <!-- =========================
       HOME
  ========================= -->
  <section class="screen active" data-screen="home">
    <div class="panel hero">
      <div>
        <h1>Bem-vindo(a), Doutor(a)</h1>
        <p>Atenda pacientes contra o tempo. Cada decis√£o importa.</p>

        <div class="hero-actions">
          <button id="btnNewGame" class="btn primary">Novo jogo</button>
          <button id="btnContinue" class="btn">Continuar</button>
        </div>
      </div>

      <div class="heroCover">
        <span>Pronto-socorro</span>
      </div>
    </div>
  </section>

  <!-- =========================
       PROFILE
  ========================= -->
  <section class="screen" data-screen="profile">
    <div class="panel profile">
      <h2>Criar perfil</h2>

      <input id="inputName" placeholder="Digite seu nome" maxlength="24"/>

      <div class="avatarGrid" id="avatarGrid">
        <button class="avatarCard" data-avatar="images/avatar1.png"><img src="images/avatar1.png" alt="Avatar 1"></button>
        <button class="avatarCard" data-avatar="images/avatar2.png"><img src="images/avatar2.png" alt="Avatar 2"></button>
        <button class="avatarCard" data-avatar="images/avatar3.png"><img src="images/avatar3.png" alt="Avatar 3"></button>
        <button class="avatarCard" data-avatar="images/avatar4.png"><img src="images/avatar4.png" alt="Avatar 4"></button>
        <button class="avatarCard" data-avatar="images/avatar5.png"><img src="images/avatar5.png" alt="Avatar 5"></button>
        <button class="avatarCard" data-avatar="images/avatar6.png"><img src="images/avatar6.png" alt="Avatar 6"></button>
      </div>

      <div class="profileActions">
        <button id="btnProfileBack" class="btn">Voltar</button>
        <button id="btnStartFromProfile" class="btn primary">Iniciar</button>
      </div>
    </div>
  </section>

  <!-- =========================
       OFFICE
  ========================= -->
  <section class="screen" data-screen="office">
    <div class="panel office">
      <div class="officeHeader">
        <img id="uiAvatar" class="officeAvatar" src="images/avatar1.png" alt="Avatar" />
        <div>
          <div id="uiName" class="officeName">‚Äî</div>
          <div id="uiRank" class="officeRank">Interno</div>
        </div>

        <div class="timer">
          ‚è±Ô∏è <span id="caseTimer">00:00</span>
        </div>
      </div>

      <div class="stats">
        <div>Pontos: <b id="uiPoints">0</b></div>
        <div>Casos: <b id="uiCases">0</b></div>
        <div>√ìbitos: <b id="uiDeaths">0</b></div>
      </div>

      <button id="btnNextCase" class="btn primary">Iniciar atendimento</button>
    </div>
  </section>

  <!-- =========================
       CASE
  ========================= -->
  <section class="screen" data-screen="case">
    <div class="panel case">
      <h2>Paciente em atendimento</h2>
      <p id="caseStatus">Tempo cr√≠tico. Atenda r√°pido.</p>

      <button id="btnFinalize" class="btn primary">Finalizar atendimento</button>
    </div>
  </section>

  <!-- =========================
       √ìBITO
  ========================= -->
  <section class="screen" data-screen="death">
    <div class="panel death">
      <h1>üü• √ìBITO</h1>
      <p>O paciente n√£o resistiu.</p>
      <button id="btnBackOffice" class="btn">Voltar ao hospital</button>
    </div>
  </section>

  <!-- =========================
       RANKING
  ========================= -->
  <div id="rankingModal" class="modal hidden" aria-hidden="true">
    <div class="modalCard">
      <h2>Ranking</h2>
      <div id="rankingList"></div>
      <button id="btnCloseRanking" class="btn">Fechar</button>
    </div>
  </div>

</div>

<!-- JS principal -->
<script src="script.js?v=2.2.1"></script>

<!-- PWA SW -->
<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js");
  }
</script>

</body>
</html>
