<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#050b16" />
  <title>Emergency Doctor Simulator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="app" class="app">
    <!-- TOP BAR (fixa) -->
    <header class="topbar">
      <div class="brand">
        <div class="brand-title">Emergency Doctor Simulator</div>
        <div class="brand-subtitle">Simulador educacional de pronto-socorro</div>
      </div>
      <div class="topbar-actions">
        <button id="btnFullscreen" class="btn btn-ghost" type="button">Tela cheia</button>
        <button id="btnHelp" class="btn btn-pill" type="button">Ajuda</button>
      </div>
    </header>

    <!-- HELP OVERLAY (todas as telas) -->
    <div id="helpOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-label="Ajuda">
      <div class="overlay-backdrop" data-close="help"></div>
      <div class="overlay-card">
        <div class="overlay-card-header">
          <div>
            <div class="overlay-title">Manual rápido (educacional)</div>
            <div class="overlay-subtitle">Conteúdo para estudo e simulação. Não substitui protocolos locais ou atendimento real.</div>
          </div>
          <button class="btn btn-ghost" data-close="help" type="button">Fechar</button>
        </div>

        <div class="overlay-card-body">
          <div class="help-grid">
            <section class="help-section">
              <h3>Triagem</h3>
              <ul>
                <li><strong>Verde:</strong> baixo risco, conduta geralmente ambulatorial/observação.</li>
                <li><strong>Amarelo:</strong> risco moderado, precisa avaliação e possíveis exames/monitorização.</li>
                <li><strong>Vermelho:</strong> alto risco, decisões rápidas; erros podem levar a desfecho grave.</li>
              </ul>
            </section>

            <section class="help-section">
              <h3>Fluxo recomendado</h3>
              <ol>
                <li>Leia queixa/história e sinais vitais.</li>
                <li>Faça perguntas (quando disponíveis) para ganhar contexto.</li>
                <li>Peça exames quando fizer sentido. Exame “errado” gera penalidade.</li>
                <li>Escolha 1 diagnóstico final.</li>
                <li>Escolha condutas/medicações (há opções erradas e perigosas).</li>
                <li>Finalize e veja o desfecho (cura/observação/piora/óbito).</li>
              </ol>
            </section>

            <section class="help-section">
              <h3>Exames (o que esperar)</h3>
              <ul>
                <li>Se o exame <strong>não</strong> se aplica ao caso: o resultado tende a vir “normal” e você perde pontos.</li>
                <li>Alguns casos têm <strong>exames essenciais</strong>. Ignorar aumenta risco de erro/óbito em casos graves.</li>
              </ul>
            </section>

            <section class="help-section">
              <h3>Segurança de medicação (no jogo)</h3>
              <ul>
                <li>Há medicações/condutas <strong>incorretas</strong> para você poder errar.</li>
                <li>Algumas são marcadas como <strong>alto risco</strong> no backend do caso e aumentam chance de piora.</li>
              </ul>
            </section>

            <section class="help-section">
              <h3>Rank e progressão</h3>
              <ul>
                <li><strong>Médico Residente</strong> → casos mais simples.</li>
                <li><strong>Médico Titular</strong> → casos intermediários, mais pegadinhas.</li>
                <li><strong>Médico Pleno</strong> → críticos e com maior punição por erro.</li>
              </ul>
              <p class="muted">A progressão é por pontuação e desempenho (acerto/erro e uso racional de exames).</p>
            </section>

            <section class="help-section">
              <h3>Observação</h3>
              <p class="muted">
                Este simulador foi desenhado para fins educacionais e de treino de raciocínio clínico.
                Não use como orientação para tratamento real.
              </p>
            </section>
          </div>
        </div>
      </div>
    </div>

    <!-- TOASTS -->
    <div id="toastHost" class="toast-host" aria-live="polite"></div>

    <!-- MAIN SCREENS -->
    <main class="stage" id="stage">

      <!-- SCREEN: HOME -->
      <section id="screenHome" class="screen active" data-screen="home">
        <div class="screen-bg" id="homeBg"></div>
        <div class="screen-content">
          <div class="hero-card">
            <div class="hero-title">EMERGENCY DOCTOR<br/>SIMULATOR</div>
            <div class="hero-subtitle">
              Tome decisões clínicas, solicite exames e conduza casos simulados.
            </div>

            <div class="notice">
              <div class="notice-title">Aviso</div>
              <div class="notice-text">
                Este jogo é uma simulação educacional. Não substitui consulta, protocolos locais,
                diretrizes oficiais ou atendimento médico real.
              </div>
            </div>

            <div class="hero-actions">
              <button id="btnNewGame" class="btn btn-primary btn-lg" type="button">Novo Jogo</button>
              <button id="btnContinue" class="btn btn-secondary btn-lg" type="button">Continuar</button>
            </div>

            <div class="hero-foot">
              <span class="muted">Dica: use “Tela cheia” para imersão máxima.</span>
            </div>
          </div>
        </div>
      </section>

      <!-- SCREEN: PROFILE -->
      <section id="screenProfile" class="screen" data-screen="profile">
        <div class="screen-bg" id="profileBg"></div>
        <div class="screen-content">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title">Perfil do Doutor</div>
              <div class="panel-subtitle">Escolha nome e avatar</div>
            </div>

            <div class="panel-body">
              <div class="form-row">
                <label class="label">Seu nome</label>
                <input id="inpDoctorName" class="input" type="text" maxlength="24" placeholder="Ex: Dr(a). Jonatan" />
              </div>

              <div class="form-row">
                <div class="label">Escolha um avatar</div>
                <div id="avatarGrid" class="avatar-grid"></div>
                <div class="muted small">Avatares: use seus arquivos em <code>images/avatar1.png</code> ... <code>images/avatar6.png</code></div>
              </div>
            </div>

            <div class="panel-footer">
              <button id="btnProfileBack" class="btn btn-ghost" type="button">Voltar</button>
              <button id="btnProfileNext" class="btn btn-primary" type="button">Confirmar</button>
            </div>
          </div>
        </div>
      </section>

      <!-- SCREEN: DIRECTOR -->
      <section id="screenDirector" class="screen" data-screen="director">
        <div class="screen-bg" id="directorBg"></div>
        <div class="screen-content">
          <div class="panel wide">
            <div class="panel-header">
              <div class="panel-title">Diretor do Hospital</div>
              <div class="panel-subtitle">Mensagem de boas-vindas</div>
            </div>

            <div class="panel-body">
              <div class="director-box">
                <div class="director-portrait"></div>
                <div class="director-message">
                  <div id="typewriter" class="typewriter"></div>
                </div>
              </div>
            </div>

            <div class="panel-footer">
              <button id="btnSkipType" class="btn btn-ghost" type="button">Pular</button>
              <button id="btnGoOffice" class="btn btn-primary" type="button" disabled>Assumir posto</button>
            </div>
          </div>
        </div>
      </section>

      <!-- SCREEN: OFFICE -->
      <section id="screenOffice" class="screen" data-screen="office">
        <div class="screen-bg" id="officeBg"></div>
        <div class="screen-content">
          <div class="office-layout">
            <aside class="hud">
              <div class="hud-card">
                <div class="hud-top">
                  <img id="hudAvatar" class="hud-avatar" alt="Avatar" />
                  <div>
                    <div id="hudName" class="hud-name">Doutor</div>
                    <div class="hud-rank">Cargo: <span id="hudRank">Médico Residente</span></div>
                  </div>
                </div>

                <div class="hud-stats">
                  <div class="stat">
                    <div class="stat-label">Pontuação</div>
                    <div id="hudScore" class="stat-value">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">Prestígio</div>
                    <div id="hudPrestige" class="stat-value">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">Acertos</div>
                    <div id="hudCorrect" class="stat-value">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">Erros</div>
                    <div id="hudWrong" class="stat-value">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">Exames errados</div>
                    <div id="hudWrongExams" class="stat-value">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">Óbitos</div>
                    <div id="hudDeaths" class="stat-value">0</div>
                  </div>
                </div>

                <div class="hud-actions">
                  <button id="btnNextCase" class="btn btn-primary" type="button">Próximo Caso</button>
                  <button id="btnSave" class="btn btn-secondary" type="button">Salvar</button>
                  <button id="btnReset" class="btn btn-ghost" type="button">Reiniciar</button>
                </div>

                <div class="hud-foot muted small">
                  Dica: exames ficam fixos no caso. Usar exame “sem sentido” penaliza.
                </div>
              </div>
            </aside>

            <section class="office-main">
              <div class="office-banner">
                <div class="office-title">Consultório de Emergência</div>
                <div class="office-subtitle">Atenda pacientes, solicite exames e tome decisões.</div>
              </div>

              <div class="office-cards">
                <div class="card">
                  <div class="card-title">Como zerar</div>
                  <div class="card-text muted">
                    Suba de cargo com pontuação e boa performance. Casos ficam mais difíceis conforme o rank.
                  </div>
                </div>
                <div class="card">
                  <div class="card-title">Sistema expansivo</div>
                  <div class="card-text muted">
                    Você adiciona novos casos apenas no <code>cases.json</code>. O visual e o motor não precisam mudar.
                  </div>
                </div>
                <div class="card">
                  <div class="card-title">Realismo (simulado)</div>
                  <div class="card-text muted">
                    Casos usam sintomas, exames e condutas plausíveis em contexto educacional. Não é orientação clínica real.
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>
      </section>

      <!-- SCREEN: CASE -->
      <section id="screenCase" class="screen" data-screen="case">
        <div class="screen-bg" id="caseBg"></div>
        <div class="screen-content">
          <div class="case-layout">
            <div class="case-left">
              <div class="panel">
                <div class="panel-header">
                  <div class="panel-title">Paciente</div>
                  <div class="panel-subtitle" id="caseMeta"></div>
                </div>

                <div class="panel-body">
                  <div class="patient-row">
                    <img id="patientPhoto" class="patient-photo" alt="Paciente" />
                    <div class="patient-info">
                      <div id="patientName" class="patient-name">Nome</div>
                      <div id="patientVitals" class="patient-vitals muted"></div>

                      <div class="triage-wrap">
                        <div class="triage-label muted small">Classificação de risco</div>
                        <div id="patientTriage" class="triage-badge">—</div>
                      </div>
                    </div>
                  </div>

                  <div class="case-text">
                    <div class="case-kv">
                      <div class="kv-key">Queixa</div>
                      <div id="caseComplaint" class="kv-value"></div>
                    </div>
                    <div class="case-kv">
                      <div class="kv-key">História</div>
                      <div id="caseHistory" class="kv-value muted"></div>
                    </div>
                  </div>

                  <div class="divider"></div>

                  <div class="section-title">Perguntas (opcional)</div>
                  <div id="questionList" class="qa-list"></div>
                </div>

                <div class="panel-footer">
                  <button id="btnBackOffice" class="btn btn-ghost" type="button">Voltar</button>
                  <button id="btnFinalize" class="btn btn-primary" type="button" disabled>Finalizar</button>
                </div>
              </div>
            </div>

            <div class="case-right">
              <div class="panel">
                <div class="panel-header">
                  <div class="panel-title">Ações</div>
                  <div class="panel-subtitle">Exames, diagnóstico e medicações</div>
                </div>

                <div class="panel-body">
                  <div class="section-title">Exames (fixos)</div>
                  <div id="examGrid" class="action-grid"></div>

                  <div class="divider"></div>

                  <div class="section-title">Diagnóstico (escolha 1)</div>
                  <div id="dxGrid" class="action-grid"></div>

                  <div class="divider"></div>

                  <div class="section-title">Medicações/Condutas (multi)</div>
                  <div id="medGrid" class="action-grid"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- RESULT OVERLAY -->
          <div id="resultOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-label="Resultado do caso">
            <div class="overlay-backdrop" data-close="result"></div>
            <div class="overlay-card large">
              <div class="overlay-card-header">
                <div>
                  <div id="resultTitle" class="overlay-title">Resultado</div>
                  <div id="resultSubtitle" class="overlay-subtitle">—</div>
                </div>
                <button class="btn btn-ghost" data-close="result" type="button">Fechar</button>
              </div>

              <div class="overlay-card-body">
                <div class="result-grid">
                  <div class="result-left">
                    <div class="result-block">
                      <div class="result-block-title">Resumo</div>
                      <div id="resultSummary" class="result-text"></div>
                    </div>

                    <div class="result-block">
                      <div class="result-block-title">Pontuação</div>
                      <div id="resultScore" class="result-text"></div>
                    </div>
                  </div>

                  <div class="result-right">
                    <div class="result-block">
                      <div class="result-block-title">Exames solicitados</div>
                      <div id="resultExams" class="result-text"></div>
                    </div>
                    <div class="result-block">
                      <div class="result-block-title">Diagnóstico escolhido</div>
                      <div id="resultDx" class="result-text"></div>
                    </div>
                    <div class="result-block">
                      <div class="result-block-title">Medicações/Condutas</div>
                      <div id="resultMeds" class="result-text"></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="overlay-card-footer">
                <button id="btnResultNext" class="btn btn-primary" type="button">Próximo caso</button>
                <button id="btnResultOffice" class="btn btn-secondary" type="button">Voltar ao consultório</button>
              </div>
            </div>
          </div>

          <!-- EXAM VIEWER OVERLAY -->
          <div id="examOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-label="Resultado de exame">
            <div class="overlay-backdrop" data-close="exam"></div>
            <div class="overlay-card large">
              <div class="overlay-card-header">
                <div>
                  <div id="examTitle" class="overlay-title">Exame</div>
                  <div id="examSubtitle" class="overlay-subtitle">Resultado simulado</div>
                </div>
                <button class="btn btn-ghost" data-close="exam" type="button">Fechar</button>
              </div>
              <div class="overlay-card-body">
                <div class="exam-view">
                  <div id="examImage" class="exam-image"></div>
                  <div id="examText" class="exam-text"></div>
                </div>
              </div>
              <div class="overlay-card-footer">
                <button class="btn btn-primary" data-close="exam" type="button">Entendi</button>
              </div>
            </div>
          </div>

        </div>
      </section>

    </main>
  </div>

  <script src="script.js"></script>
</body>
</html>
